<%- include('partials/header', {page: page}) %>



    <div class="container text-center  mx-5 px-5">
        <%- include('partials/alert') %>
            <% if (portfolio.userHoldings.length) { %>

                <div class='container mt-4 px-5 py-4 bg-light'>

                    <h2 class='fw-light'>Portfolio Overview</h2>
                    <div class='row mt-3'>
                        <div class="col border border-dark">
                            <h5>Total Value:
                            </h5>
                            <h3 class="fw-light">
                                $<%-portfolio.totalValue[1]%>
                            </h3>
                        </div>

                        <div class="col border border-dark">
                            <h5>Total Cost:</h5>
                            <h3 class="fw-light">$<%-portfolio.totalCost[1]%>
                            </h3>
                        </div>
                        <div class="col border border-dark">
                            <h5>Current Yield:</h5>
                            <h3
                                class="fw-light <%=(portfolio.currentValue[0] < 0) ? ' text-danger' : 'text-success' %>">
                                $
                                <%-portfolio.currentValue[1]%>, (<%-portfolio.currentPercent[1]%>%)
                            </h3>
                        </div>
                    </div>


                </div>
                <div class='container border border-secondary mt-5 text-center'>

                    <h2 class='mt-3 fw-light'>All Positions</h2>

                    <table class="table table-hover table-striped">
                        <thead>
                            <tr>
                                <th scope="col">Ticker</th>
                                <th scope="col">Position</th>
                                <th scope="col">Buy Price</th>
                                <th scope="col">Last Price</th>
                                <th scope="col">Position Value</th>
                                <th scope="col">Unrealised Pofit/Loss</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% for (let stock of portfolio.userHoldings) { %>
                                <tr onclick="linkTo('<%-stock.ticker%>')">
                                    <td scope="row">
                                        <%- stock.ticker %>
                                    </td>
                                    <td>
                                        <%- stock.quantity %>
                                    </td>
                                    <td>
                                        $<%- stock.price %>
                                    </td>
                                    <td>
                                        $<%- stock.lastPrice[1] %>

                                    </td>
                                    <td>
                                        $<%- stock.posValue[1] %>
                                    </td>
                                    <td class=<%=(stock.unrealisedValue[0] < 0) ? 'text-danger' : 'text-success' %>>
                                        $<%- stock.unrealisedValue[1]%>, (<%- stock.unrealisedPercent[1]%>%)
                                    </td>
                                </tr>
                                <% } %>


                        </tbody>
                    </table>
                </div>
                <div class='mt-3 d-flex justify-content-center'>
                    <div class='btn-group' role="group">
                        <a class="btn btn-sm btn-outline-dark" href='/buy'>+</a>
                        <a class="btn btn-sm btn-outline-dark" href='/sell'>-</a>
                    </div>
                </div>
                <% } else { %>
                    <div class='mt-5'>
                        <h3>You do not own any stocks.</h3>
                        <a class="btn btn-outline-dark" href='/buy'>Add a stock</a>
                    </div>
                    <% } %>


    </div>

    <script src="table.js"></script>


    <%- include('partials/footer') %>